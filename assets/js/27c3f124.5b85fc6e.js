"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[892],{3905:(e,t,n)=>{n.d(t,{Zo:()=>i,kt:()=>m});var l=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,l,a=function(e,t){if(null==e)return{};var n,l,a={},r=Object.keys(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=l.createContext({}),u=function(e){var t=l.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},i=function(e){var t=u(e.components);return l.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},p=l.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),p=u(n),m=a,k=p["".concat(c,".").concat(m)]||p[m]||d[m]||r;return n?l.createElement(k,s(s({ref:t},i),{},{components:n})):l.createElement(k,s({ref:t},i))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=p;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var u=2;u<r;u++)s[u]=n[u];return l.createElement.apply(null,s)}return l.createElement.apply(null,n)}p.displayName="MDXCreateElement"},6154:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var l=n(7462),a=(n(7294),n(3905));const r={sidebar_label:"Local Cluster",sidebar_position:2},s="Local Cluster Mode",o={unversionedId:"commands/local-cluster",id:"commands/local-cluster",title:"Local Cluster Mode",description:"This feature is currently supported only on Linux and MacOS",source:"@site/docs/commands/local-cluster.md",sourceDirName:"commands",slug:"/commands/local-cluster",permalink:"/docs/commands/local-cluster",draft:!1,editUrl:"https://github.com/bloxbean/yaci-cli/tree/main/docs/docs/commands/local-cluster.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Local Cluster",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"tail",permalink:"/docs/commands/tail"}},c={},u=[{value:"1. Create a Cluster",id:"1-create-a-cluster",level:2},{value:"Create Cluster - Customization",id:"create-cluster---customization",level:3},{value:"a. Ports",id:"a-ports",level:4},{value:"b. Slot Length",id:"b-slot-length",level:4},{value:"2. List Clusters",id:"2-list-clusters",level:2},{value:"3. Enter Cluster Mode",id:"3-enter-cluster-mode",level:2},{value:"4. Start a cluster",id:"4-start-a-cluster",level:2},{value:"5. Show recent logs",id:"5-show-recent-logs",level:2},{value:"6. Show default accounts",id:"6-show-default-accounts",level:2},{value:"7. Top-up a new address with test Ada",id:"7-top-up-a-new-address-with-test-ada",level:2},{value:"8. Check Utxos at an Address",id:"8-check-utxos-at-an-address",level:2},{value:"9. Check Tip",id:"9-check-tip",level:2},{value:"10. Tail a running cluster",id:"10-tail-a-running-cluster",level:2},{value:"11. Stop Cluster",id:"11-stop-cluster",level:2},{value:"12. Get Cluster Info",id:"12-get-cluster-info",level:2},{value:"13. Delete a Cluster",id:"13-delete-a-cluster",level:2}],i={toc:u};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,l.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"local-cluster-mode"},"Local Cluster Mode"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"This feature is currently supported only on ",(0,a.kt)("strong",{parentName:"p"},"Linux")," and ",(0,a.kt)("strong",{parentName:"p"},"MacOS"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Need your own Cardano private network during development ?")),(0,a.kt)("p",null,"Using Local Cluster Mode commands, you can easily create and manage one or more 3-nodes local private network(s) on your local machine.\nThese networks are created from a pre-define cluster template. The current version of Yaci CLI allows to customize ",(0,a.kt)("inlineCode",{parentName:"p"},"slotLength"),"\nand ",(0,a.kt)("inlineCode",{parentName:"p"},"node ports"),". "),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Make sure you have copied ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node")," binary to ",(0,a.kt)("inlineCode",{parentName:"p"},"$user_home/.yaci-cli/bin")," folder. This folder\nwill be automatically created when you run yaci-cli first time."),(0,a.kt)("p",{parentName:"admonition"},"Set executable permission for ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node")," binary. (if required)")),(0,a.kt)("h2",{id:"1-create-a-cluster"},"1. Create a Cluster"),(0,a.kt)("p",null,"Create a cluster with ",(0,a.kt)("inlineCode",{parentName:"p"},"create-cluster")," command. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yaci-cli:>create-cluster mydevcluster\n\n")),(0,a.kt)("p",null,"The above command will create a cluster with name ",(0,a.kt)("inlineCode",{parentName:"p"},"mydevcluster"),". The cluster folder can be found at\n",(0,a.kt)("inlineCode",{parentName:"p"},"$user_home/.yaci-cli/local-clusters/mydevcluster")),(0,a.kt)("p",null,"If the cluster creation is successful, you will see the cluster details like node ports and socket file locations."),(0,a.kt)("p",null,"Output (Example):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[Success] Create cluster folder !!!\n[Success] Slot length updated in genesis.json\n[Success] Update ports\n[Success] Create Cluster : mydevcluster\n\n###### Node Details ######\n[Node ports] 3001 - 3002 - 3003\n[Node Socket Paths] \n$userhome/.yaci-cli/local-clusters/mydevcluster/node-spo1/node.sock\n$userhome/.yaci-cli/local-clusters/mydevcluster/node-spo2/node.sock\n$userhome/.yaci-cli/local-clusters/mydevcluster/node-spo3/node.sock\n")),(0,a.kt)("h3",{id:"create-cluster---customization"},"Create Cluster - Customization"),(0,a.kt)("h4",{id:"a-ports"},"a. Ports"),(0,a.kt)("p",null,"By default, create-cluster command uses ",(0,a.kt)("inlineCode",{parentName:"p"},"3000"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"3001"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"3002")," as node ports. To start nodes with different ports, you\ncan use ",(0,a.kt)("inlineCode",{parentName:"p"},"--ports")," option."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yaci-cli:>create-cluster mydevcluster --ports 5001 5002 5003\n")),(0,a.kt)("p",null,"The above command will create a cluster with ports 5001, 5002 and 5003."),(0,a.kt)("h4",{id:"b-slot-length"},"b. Slot Length"),(0,a.kt)("p",null,"By default, slotLength is set to 1 (1 sec). But if you want to create a cluster with different slot length,\nyou can do that using ",(0,a.kt)("inlineCode",{parentName:"p"},"--slotLength")," option during cluster creation."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yaci-cli:>create-cluster mydevcluster --slotLength 0.2\n")),(0,a.kt)("p",null,"The above command will create a cluster with 200ms slot length and hence shorter block time."),(0,a.kt)("h2",{id:"2-list-clusters"},"2. List Clusters"),(0,a.kt)("p",null,"To see the available clusters, use ",(0,a.kt)("inlineCode",{parentName:"p"},"list-clusters")," command."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yaci-cli:>list-clusters \nAvailable Clusters:\nmydevcluster\ndemocluster\n")),(0,a.kt)("h2",{id:"3-enter-cluster-mode"},"3. Enter Cluster Mode"),(0,a.kt)("p",null,"To start/stop and use other cluster mode commands, you need to enter the cluster mode for a cluster.\nUse ",(0,a.kt)("inlineCode",{parentName:"p"},"cluster")," command to enter cluster mode."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yaci-cli:>cluster mydevcluster\n")),(0,a.kt)("p",null,"Output (Example) :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[Success] Switched to mydevcluster\nlocal-cluster:mydevcluster>\n")),(0,a.kt)("h2",{id:"4-start-a-cluster"},"4. Start a cluster"),(0,a.kt)("p",null,"Once you are in cluster mode for a cluster, you can start the cluster with ",(0,a.kt)("inlineCode",{parentName:"p"},"start")," command."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>start\n")),(0,a.kt)("p",null,"If sucessful, you should see success message with a swagger-ui url. Using swagger-ui, you can interact\nwith the cluster. But currently only few endpoints are there. (Current epoch, address utxos etc.)\nYou can also interact with the cluster through ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-cli"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>start\n[Success] Update Start time\n[Success] Starting node from directory : $userhome/.yaci-cli/local-clusters/mydevcluster/node-spo1\n[Success] Starting node from directory : $userhome/.yaci-cli/local-clusters/mydevcluster/node-spo2\n[Success] Starting node from directory : $userhome/.yaci-cli/local-clusters/mydevcluster/node-spo3\n[Info] Swagger Url to interact with the cluster's node : http://localhost:50056/swagger-ui.html\n")),(0,a.kt)("h2",{id:"5-show-recent-logs"},"5. Show recent logs"),(0,a.kt)("p",null,"To show recent logs, use ",(0,a.kt)("inlineCode",{parentName:"p"},"logs")," command. It shows recent logs (last few hundreds lines) from each nodes."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>logs\n")),(0,a.kt)("h2",{id:"6-show-default-accounts"},"6. Show default accounts"),(0,a.kt)("p",null,"Using ",(0,a.kt)("inlineCode",{parentName:"p"},"show-default-accounts")," command, you can see the available default accounts and utxos."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>show-default-accounts\n")),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"Address\naddr_test1vzs0r2nae22szlq3ul3h8t4u7rz9dr850mqjh98caddm4zcypzjjt\nUtxos\n347e9d3c72ddc52bdb43cf1c44d31507983c102e870398b9205fb8ed125f7e64#0 : [Amount(unit=lovelace, quantity=300000000000)]\n\nAddress\naddr_test1vpf8vv32c7yzgdqh8hxxgsvstannw6ym6vymdzkckds5lkq4jtrmx\nUtxos\n650aae802cf0f3f5b214b6669caf823c34ff3648d749a8367bceed4bf64b2ae6#0 : [Amount(unit=lovelace, quantity=300000000000)]\n\nAddress\naddr_test1vzaf27s0la5pvqsm9ta8jq97af506y8j678mtdjdurfr08qkeh3t3\nUtxos\nc59295f675c40a068596c0b816c997a8a2f564d6c090d5242444cf79d0ddec48#0 : [Amount(unit=lovelace, quantity=300000000000)]\n")),(0,a.kt)("h2",{id:"7-top-up-a-new-address-with-test-ada"},"7. Top-up a new address with test Ada"),(0,a.kt)("p",null,"To topup a new address with some test Ada, you can use ",(0,a.kt)("inlineCode",{parentName:"p"},"topup")," command. It uses one of the default account\nand sends ada to the provided address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>topup <address> --value <ada value>\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>topup addr_test1qqwpl7h3g84mhr36wpetk904p7fchx2vst0z696lxk8ujsjyruqwmlsm344gfux3nsj6njyzj3ppvrqtt36cp9xyydzqzumz82 --value 5000\n")),(0,a.kt)("h2",{id:"8-check-utxos-at-an-address"},"8. Check Utxos at an Address"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"utxos")," command to check utxos at an address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>utxos <address>\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>utxos addr_test1qqwpl7h3g84mhr36wpetk904p7fchx2vst0z696lxk8ujsjyruqwmlsm344gfux3nsj6njyzj3ppvrqtt36cp9xyydzqzumz82\nf25ba08f473abbda5741a1c749a4eb067698a6342fe6be2aa87f5acbf0261307#0 : [Amount(unit=lovelace, quantity=5000000000)]\n")),(0,a.kt)("h2",{id:"9-check-tip"},"9. Check Tip"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"tip")," command to get the latest tip (Block no, Slot, Block Hash)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>tip\n")),(0,a.kt)("p",null,"Output (Example):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>tip\n[Block#] 2\n[Slot#] 75\n[Block Hash] e3f06194a390f486f8fad6ebe051bdf3f6066a23cd2d264fa11c492c488d2a3b\n")),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"If the server is still starting up, the ",(0,a.kt)("inlineCode",{parentName:"p"},"tip")," command may show the following error. In that case, just wait for\nsometime and then try again."),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[ERROR] Find tip error : Timeout on blocking read for 5000000000 NANOSECONDS\n"))),(0,a.kt)("h2",{id:"10-tail-a-running-cluster"},"10. Tail a running cluster"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ltail")," command is similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"tail")," command. But instead of connecting to a remote node, ",(0,a.kt)("inlineCode",{parentName:"p"},"ltail"),"\ncommand connects to currently running local cluster. This command can be used only in cluster mode."),(0,a.kt)("p",null,"Output (Example):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>ltail\n\n=========================Connection Info=========================\nHost          : localhost\nPort          : 3001\nProtocolMagic : 42\n\n2022-10-13 23:26:30,345 1633 [           main] INFO  c.b.c.y.c.p.chainsync.n2n.ChainsyncAgent - Trying to find the point [slot=0, hash='null']\n\n\nBlock : 178\n\nOutputs\n--------------------------------------------------------------------------------\nTransactions  : 0\nBlock Size    : 0 KB\n\n\n[ / ] Waiting for next block...\n")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"p"},"Known Issue:"),"\nIf you try to exit from ",(0,a.kt)("inlineCode",{parentName:"p"},"ltail")," command using ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl + c"),", it doesn't exit gracefully and it stops the running cluster.\nSo you need to exit from yaci-cli to restart the cluster again."),(0,a.kt)("p",{parentName:"admonition"},"To ",(0,a.kt)("strong",{parentName:"p"},"avoid")," this, it is recommended to start ",(0,a.kt)("inlineCode",{parentName:"p"},"ltail")," command in a ",(0,a.kt)("strong",{parentName:"p"},"separate")," terminal after entering to the same cluster mode.")),(0,a.kt)("h2",{id:"11-stop-cluster"},"11. Stop Cluster"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"stop")," command to stop the cluster."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>stop\n")),(0,a.kt)("p",null,"If successful, you should see similar output"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'[Info] Trying to stop the running cluster ...\n[Process] 2440\n[Process] 2439\n[Info] Stopping node process : Process[pid=2437, exitValue="not exited"]\n[Success] Killed : Process[pid=2437, exitValue=143]\n[Process] 2443\n[Process] 2442\n[Info] Stopping node process : Process[pid=2438, exitValue="not exited"]\n[Success] Killed : Process[pid=2438, exitValue=143]\n[Process] 2446\n[Process] 2445\n[Info] Stopping node process : Process[pid=2441, exitValue="not exited"]\n[Success] Killed : Process[pid=2441, exitValue=143]\n')),(0,a.kt)("h2",{id:"12-get-cluster-info"},"12. Get Cluster Info"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"info")," command to get information about the cluster."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>info\n")),(0,a.kt)("p",null,"Output (Example):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"###### Node Details ######\n[Node ports] 3001 - 3002 - 3003\n[Node Socket Paths] \n/Users/xxx/.yaci-cli/local-clusters/mydevcluster/node-spo1/node.sock\n/Users/xxx/.yaci-cli/local-clusters/mydevcluster/node-spo2/node.sock\n/Users/xxx/.yaci-cli/local-clusters/mydevcluster/node-spo3/node.sock\n")),(0,a.kt)("h2",{id:"13-delete-a-cluster"},"13. Delete a Cluster"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"delete-cluster")," command to delete an existing cluster."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"local-cluster:mydevcluster>delete-cluster mydevcluster\n")))}d.isMDXComponent=!0}}]);